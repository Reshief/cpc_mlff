2023-06-19 18:54:40,454 INFO    MainThread:73415 [wandb_setup.py:_flush():76] Current SDK version is 0.15.2
2023-06-19 18:54:40,454 INFO    MainThread:73415 [wandb_setup.py:_flush():76] Configure stats pid to 73415
2023-06-19 18:54:40,454 INFO    MainThread:73415 [wandb_setup.py:_flush():76] Loading settings from /Users/thorbenfrank/.config/wandb/settings
2023-06-19 18:54:40,454 INFO    MainThread:73415 [wandb_setup.py:_flush():76] Loading settings from /Users/thorbenfrank/Documents/git/mlff-public/examples/wandb/settings
2023-06-19 18:54:40,454 INFO    MainThread:73415 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2023-06-19 18:54:40,454 INFO    MainThread:73415 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-06-19 18:54:40,454 INFO    MainThread:73415 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'examples/train_so3krates.py', 'program': '/Users/thorbenfrank/Documents/git/mlff-public/examples/train_so3krates.py'}
2023-06-19 18:54:40,455 INFO    MainThread:73415 [wandb_init.py:_log_setup():507] Logging user logs to /Users/thorbenfrank/Documents/git/mlff-public/examples/wandb/run-20230619_185440-bmjgx4ur/logs/debug.log
2023-06-19 18:54:40,455 INFO    MainThread:73415 [wandb_init.py:_log_setup():508] Logging internal logs to /Users/thorbenfrank/Documents/git/mlff-public/examples/wandb/run-20230619_185440-bmjgx4ur/logs/debug-internal.log
2023-06-19 18:54:40,456 INFO    MainThread:73415 [wandb_init.py:init():547] calling init triggers
2023-06-19 18:54:40,457 INFO    MainThread:73415 [wandb_init.py:init():554] wandb.init called with sweep_config: {}
config: {'stack_net': {'geometry_embeddings': [{'geometry_embed': {'degrees': [1, 2], 'radial_basis_function': 'phys', 'n_rbf': 32, 'radial_cutoff_fn': 'cosine_cutoff_fn', 'r_cut': 5, 'sphc': True, 'sphc_normalization': None, 'solid_harmonic': False, 'mic': False, 'input_convention': 'positions', 'prop_keys': {'energy': 'E', 'force': 'F', 'atomic_position': 'R', 'atomic_type': 'z', 'idx_i': 'idx_i', 'idx_j': 'idx_j', 'unit_cell': 'unit_cell', 'pbc': 'pbc', 'cell_offset': 'cell_offset', 'stress': 'stress', 'node_mask': 'node_mask'}}}], 'feature_embeddings': [{'atom_type_embed': {'num_embeddings': 100, 'features': 32, 'prop_keys': {'energy': 'E', 'force': 'F', 'atomic_position': 'R', 'atomic_type': 'z', 'idx_i': 'idx_i', 'idx_j': 'idx_j', 'unit_cell': 'unit_cell', 'pbc': 'pbc', 'cell_offset': 'cell_offset', 'stress': 'stress', 'node_mask': 'node_mask'}}}], 'layers': [{'so3krates_layer': {'fb_filter': 'radial_spherical', 'fb_rad_filter_features': [32, 32], 'fb_sph_filter_features': [8, 32], 'fb_attention': 'conv_att', 'gb_filter': 'radial_spherical', 'gb_rad_filter_features': [32, 32], 'gb_sph_filter_features': [8, 32], 'gb_attention': 'conv_att', 'n_heads': 2, 'non_local_sphc': False, 'non_local_feature': False, 'fast_attention_kwargs': None, 'chi_cut': None, 'chi_cut_dynamic': False, 'degrees': [1, 2], 'parity': True, 'layer_normalization': False, 'sphc_normalization': False, 'neighborhood_normalization': False, 'final_layer': False}}, {'so3krates_layer': {'fb_filter': 'radial_spherical', 'fb_rad_filter_features': [32, 32], 'fb_sph_filter_features': [8, 32], 'fb_attention': 'conv_att', 'gb_filter': 'radial_spherical', 'gb_rad_filter_features': [32, 32], 'gb_sph_filter_features': [8, 32], 'gb_attention': 'conv_att', 'n_heads': 2, 'non_local_sphc': False, 'non_local_feature': False, 'fast_attention_kwargs': None, 'chi_cut': None, 'chi_cut_dynamic': False, 'degrees': [1, 2], 'parity': True, 'layer_normalization': False, 'sphc_normalization': False, 'neighborhood_normalization': False, 'final_layer': False}}], 'observables': [{'energy': {'per_atom_scale': None, 'per_atom_shift': None, 'num_embeddings': 100, 'output_convention': 'per_structure', 'prop_keys': {'energy': 'E', 'force': 'F', 'atomic_position': 'R', 'atomic_type': 'z', 'idx_i': 'idx_i', 'idx_j': 'idx_j', 'unit_cell': 'unit_cell', 'pbc': 'pbc', 'cell_offset': 'cell_offset', 'stress': 'stress', 'node_mask': 'node_mask'}}}], 'prop_keys': {'energy': 'E', 'force': 'F', 'atomic_position': 'R', 'atomic_type': 'z', 'idx_i': 'idx_i', 'idx_j': 'idx_j', 'unit_cell': 'unit_cell', 'pbc': 'pbc', 'cell_offset': 'cell_offset', 'stress': 'stress', 'node_mask': 'node_mask'}, 'n_layers': 2}, 'optimizer': {'learning_rate': 0.001, 'transition_steps': None, 'decay_rate': None, 'weight_decay': None, 'clip_by_global_norm': None}, 'coach': {'inputs': ['atomic_position', 'atomic_type', 'idx_i', 'idx_j', 'node_mask'], 'targets': ['energy'], 'epochs': 1000, 'training_batch_size': 5, 'validation_batch_size': 5, 'loss_weights': {'energy': 0.01, 'force': 0.99}, 'ckpt_dir': 'ckpt_dir/module', 'data_path': 'example_data/ethanol.npz', 'training_seed': 0, 'net_seed': 0, 'stop_lr_min': None, 'stop_metrics_min': None}, 'dataset': {'split': {'n_train': 200, 'n_valid': 200, 'n_test': 1600, 'n_data': 2000, 'r_cut': 5, 'mic': False}}, 'train_state': {'plateau_lr_decay': {'patience': 50, 'decay_factor': 1.0}, 'scheduled_lr_decay': {'exponential': {'transition_steps': 10000, 'decay_factor': 0.9}}, 'lr_warmup': None}}
2023-06-19 18:54:40,458 INFO    MainThread:73415 [wandb_init.py:init():596] starting backend
2023-06-19 18:54:40,458 INFO    MainThread:73415 [wandb_init.py:init():600] setting up manager
2023-06-19 18:54:40,461 INFO    MainThread:73415 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=spawn,fork,forkserver, using: spawn
2023-06-19 18:54:40,466 INFO    MainThread:73415 [wandb_init.py:init():606] backend started and connected
2023-06-19 18:54:40,477 INFO    MainThread:73415 [wandb_init.py:init():700] updated telemetry
2023-06-19 18:54:40,521 INFO    MainThread:73415 [wandb_init.py:init():737] communicating run to backend with 60.0 second timeout
2023-06-19 18:54:57,412 INFO    MainThread:73415 [wandb_run.py:_on_init():2177] communicating current version
2023-06-19 18:54:59,099 INFO    MainThread:73415 [wandb_run.py:_on_init():2186] got version response upgrade_message: "wandb version 0.15.4 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2023-06-19 18:54:59,099 INFO    MainThread:73415 [wandb_init.py:init():787] starting run threads in backend
2023-06-19 18:54:59,162 INFO    MainThread:73415 [wandb_run.py:_console_start():2158] atexit reg
2023-06-19 18:54:59,162 INFO    MainThread:73415 [wandb_run.py:_redirect():2013] redirect: SettingsConsole.WRAP_RAW
2023-06-19 18:54:59,162 INFO    MainThread:73415 [wandb_run.py:_redirect():2078] Wrapping output streams.
2023-06-19 18:54:59,163 INFO    MainThread:73415 [wandb_run.py:_redirect():2103] Redirects installed.
2023-06-19 18:54:59,163 INFO    MainThread:73415 [wandb_init.py:init():829] run started, returning control to user process
2023-06-19 19:03:21,181 WARNING MsgRouterThr:73415 [router.py:message_loop():77] message_loop has been closed
